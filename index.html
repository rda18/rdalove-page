<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<title>我和蓉蛋的纪念日</title>
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<style>
:root {
  --main-color: white;
  --overlay-color: rgba(0,0,0,0.5);
  --font-family: "Arial", sans-serif;
  --fade-speed: 1000ms;
}
* { margin: 0; padding: 0; box-sizing: border-box; }
html, body {
  height: 100%;
  font-family: var(--font-family);
  color: var(--main-color);
  overflow: hidden;
  background: url('background.jpg') no-repeat center center fixed;
  background-size: cover;
  position: relative;
  transition: background var(--fade-speed) ease-in-out;
}
@media(max-width:768px) {
  html, body { background-attachment: scroll; }
}
.overlay {
  background-color: var(--overlay-color);
  position: absolute;
  inset: 0;
  z-index: 1;
}
.content {
  position: relative;
  z-index: 2;
  width: 100%;
  height: 100%;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  text-align: center;
  padding: 1rem;
}
h1 {
  font-size: clamp(1.8rem,5vw,2.5rem);
  margin-bottom: 1rem;
  font-weight: bold;
}
.timer {
  font-size: 1.1rem;
  margin-bottom: 1rem;
}

/* ❤️ 心脏跳动动画 */
.heart {
  display: inline-block;
  font-size: 2rem;
  animation: heartbeat-real 1.5s ease-in-out infinite;
  transform-origin: center;
}
@keyframes heartbeat-real {
  0% { transform: scale(1); }
  10% { transform: scale(1.3); }
  20% { transform: scale(1); }
  30% { transform: scale(1.3); }
  40% { transform: scale(1); }
  100% { transform: scale(1); }
}

/* 打字机效果 + 光标 */
.quote {
  font-size: 1rem;
  margin-top: 1rem;
  max-width: 80%;
  line-height: 1.5;
  font-style: italic;
  min-height: 2.5rem;
  white-space: pre-wrap;
  position: relative;
}
.quote::after {
  content: "|";
  position: absolute;
  animation: blink 1s infinite;
}
@keyframes blink {
  0%, 50% { opacity: 1; }
  51%, 100% { opacity: 0; }
}

.music-control { margin-top: 1.5rem; }
.music-control button {
  padding: .6rem 1.2rem;
  font-size: 1rem;
  border: none;
  border-radius: .5rem;
  cursor: pointer;
  background-color: rgba(255,255,255,.2);
  color: white;
  transition: background-color .3s;
}
.music-control button:hover {
  background-color: rgba(255,255,255,.4);
}
.particles {
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: 0;
}
audio { display: none; }
</style>
</head>
<body>
<div class="overlay"></div>
<canvas class="particles"></canvas>
<div class="content">
  <h1>和蓉蛋在一起的第 <span id="loveDays"></span> 天 <span class="heart">❤️</span></h1>
  <div class="timer" id="beijingTime"></div>
  <div class="quote" id="quote"></div>
  <div class="music-control"><button id="musicToggle">播放音乐 🎵</button></div>
</div>
<audio id="bgm" loop>
  <source src="music.mp3" type="audio/mpeg">
</audio>

<script>
const CONFIG = {
  startDate: new Date("2024-02-09T00:00:00"),
  quotes: [
    "有你在的日子，每一天都是情人节。",
    "你笑起来的样子，是我见过最美的风景。",
    "陪你走过的每一步，都是我最珍贵的回忆。",
    "时间会老去，但我们的爱不会。",
    "星河滚烫，你是人间理想。",
    "我见过的风景很多，但最喜欢的还是你。",
    "世界再大，我的眼中也只有你。",
    "遇见你，是我最美的意外。",
    "和你在一起的日子，才叫时光。",
    "你是我疲惫生活里的温柔梦想。",
    "所有的温柔和浪漫，都藏在你的名字里。",
    "我想和你一起慢慢变老。",
    "爱你，是我最坚定的选择。",
    "你是我此生唯一的心动。",
    "在我的世界里，你是唯一的光。",
    "你是我心底最柔软的牵挂。",
    "一想到余生有你，就充满期待。",
    "你是我眼中最美的风景线。",
    "我愿化作星辰，只为守护你。",
    "你的笑，是我每天的太阳。",
    "我想牵你的手，一直走到白发苍苍。",
    "和你一起的每一秒，都是礼物。",
    "你是我心中的不变信仰。",
    "我愿意为你挡住所有风雨。",
    "这一生，有你足矣。",
    "你是我最深的执念。",
    "你是我生命中最亮的光。",
    "和你在一起，才有了家的感觉。",
    "每一次想你，心里都开出花来。",
    "你是我所有故事的主角。",
    "你是我的今天，也是我的明天。",
    "有你在，连空气都是甜的。",
    "你是我梦里最温柔的诗。",
    "你是我心中永不落的星。",
    "爱你，是我每天最想做的事。",
    "你的名字，是我唇边最美的词。",
    "我想把所有温柔都给你。",
    "你是我生命中最幸运的遇见。",
    "我会一直爱你，不论风雨。",
    "你是我心里最柔软的地方。",
    "你是我的避风港，也是我的方向。",
    "你是我唯一的答案。",
    "每一次拥抱你，都像回到家。",
    "我想和你看遍世间风景。",
    "你是我眼里最亮的星。",
    "我愿意一生守护你。",
    "有你在的日子，才叫生活。",
    "你是我心中的唯一选择。",
    "我会爱你，直到时间的尽头。"
  ]
};

const loveDaysEl = document.getElementById("loveDays");
const beijingTimeEl = document.getElementById("beijingTime");
const quoteEl = document.getElementById("quote");
const audio = document.getElementById("bgm");
const toggleBtn = document.getElementById("musicToggle");

function fadeAudio(targetVolume, duration = 1000, callback) {
  const startVolume = audio.volume;
  const startTime = performance.now();
  function step(now) {
    const progress = Math.min((now - startTime) / duration, 1);
    audio.volume = startVolume + (targetVolume - startVolume) * progress;
    if (progress < 1) {
      requestAnimationFrame(step);
    } else if (callback) callback();
  }
  requestAnimationFrame(step);
}

function updateDays() {
  loveDaysEl.textContent = Math.floor((Date.now() - CONFIG.startDate) / 86400000);
}

function updateBeijingTime() {
  const now = new Date();
  const beijing = new Date(now.getTime() + now.getTimezoneOffset() * 60000 + 8 * 3600000);
  beijingTimeEl.textContent = "北京时间：" + beijing.toLocaleTimeString("zh-CN", { hour12: false });
}

// 打字机效果
let quoteIndex = 0;
function typeWriter(text, callback) {
  let i = 0;
  quoteEl.textContent = "";
  function typing() {
    if (i < text.length) {
      quoteEl.textContent += text.charAt(i);
      i++;
      setTimeout(typing, 80);
    } else if (callback) {
      setTimeout(callback, 2000);
    }
  }
  typing();
}
function playQuotes() {
  typeWriter(CONFIG.quotes[quoteIndex], () => {
    quoteIndex = (quoteIndex + 1) % CONFIG.quotes.length;
    playQuotes();
  });
}

// 粒子动画
const canvas = document.querySelector(".particles");
const ctx = canvas.getContext("2d");
let particles = [];
function resizeCanvas() {
  canvas.width = innerWidth;
  canvas.height = innerHeight;
  particles = Array.from({ length: 30 }, createParticle);
}
function createParticle() {
  return {
    x: Math.random() * canvas.width,
    y: Math.random() * canvas.height,
    size: 10 * Math.random() + 10,
    speed: Math.random() + 0.5,
    opacity: Math.random()
  };
}
function drawParticles() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  ctx.fillStyle = "rgba(255,100,150,0.6)";
  ctx.font = "15px sans-serif";
  particles.forEach(p => {
    ctx.globalAlpha = p.opacity;
    ctx.fillText("❤", p.x, p.y);
    p.y -= p.speed;
    if (p.y < -20) Object.assign(p, createParticle(), { y: canvas.height + 10 });
  });
  ctx.globalAlpha = 1;
}

function mainLoop(timestamp) {
  updateDays();
  updateBeijingTime();
  drawParticles();
  requestAnimationFrame(mainLoop);
}

function tryAutoPlay() {
  audio.volume = 0;
  audio.play().then(() => {
    fadeAudio(1, 2000);
    toggleBtn.textContent = "暂停音乐 ⏸️";
  }).catch(() => {
    toggleBtn.textContent = "播放音乐 🎵";
  });
}

toggleBtn.addEventListener("click", () => {
  if (audio.paused) {
    audio.play().then(() => {
      fadeAudio(1, 2000);
      toggleBtn.textContent = "暂停音乐 ⏸️";
    });
  } else {
    fadeAudio(0, 1500, () => {
      audio.pause();
      toggleBtn.textContent = "播放音乐 🎵";
    });
  }
});

addEventListener("resize", resizeCanvas);
resizeCanvas();
document.addEventListener("DOMContentLoaded", () => {
  tryAutoPlay();
  playQuotes();
});
mainLoop(0);
</script>
</body>
</html>
