<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<title>æˆ‘å’Œè“‰è›‹çš„çºªå¿µæ—¥</title>
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<style>
:root {
  --main-color: white;
  --overlay-color: rgba(0,0,0,0.5);
  --font-family: "Arial", sans-serif;
  --fade-speed: 1000ms;
}
* { margin: 0; padding: 0; box-sizing: border-box; }
html, body {
  height: 100%;
  font-family: var(--font-family);
  color: var(--main-color);
  overflow: hidden;
  background: url('background.jpg') no-repeat center center fixed;
  background-size: cover;
  position: relative;
  transition: background var(--fade-speed) ease-in-out;
}
@media(max-width:768px) {
  html, body { background-attachment: scroll; }
}
.overlay {
  background-color: var(--overlay-color);
  position: absolute;
  inset: 0;
  z-index: 1;
}
.content {
  position: relative;
  z-index: 2;
  width: 100%;
  height: 100%;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  text-align: center;
  padding: 1rem;
}
h1 {
  font-size: clamp(1.8rem,5vw,2.5rem);
  margin-bottom: 1rem;
  font-weight: bold;
}
.timer {
  font-size: 1.1rem;
  margin-bottom: 1rem;
}

/* â¤ï¸ å¿ƒè„è·³åŠ¨åŠ¨ç”» */
.heart {
  display: inline-block;
  font-size: 2rem;
  animation: heartbeat-real 1.5s ease-in-out infinite;
  transform-origin: center;
}
@keyframes heartbeat-real {
  0% { transform: scale(1); }
  10% { transform: scale(1.3); }
  20% { transform: scale(1); }
  30% { transform: scale(1.3); }
  40% { transform: scale(1); }
  100% { transform: scale(1); }
}

/* æ‰“å­—æœºæ•ˆæœ + å…‰æ ‡ */
.quote {
  font-size: 1rem;
  margin-top: 1rem;
  max-width: 80%;
  line-height: 1.5;
  font-style: italic;
  min-height: 2.5rem;
  white-space: pre-wrap;
  position: relative;
}
.quote::after {
  content: "|";
  position: absolute;
  animation: blink 1s infinite;
}
@keyframes blink {
  0%, 50% { opacity: 1; }
  51%, 100% { opacity: 0; }
}

.music-control { margin-top: 1.5rem; }
.music-control button {
  padding: .6rem 1.2rem;
  font-size: 1rem;
  border: none;
  border-radius: .5rem;
  cursor: pointer;
  background-color: rgba(255,255,255,.2);
  color: white;
  transition: background-color .3s;
}
.music-control button:hover {
  background-color: rgba(255,255,255,.4);
}
.particles {
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: 0;
}
audio { display: none; }
</style>
</head>
<body>
<div class="overlay"></div>
<canvas class="particles"></canvas>
<div class="content">
  <h1>å’Œè“‰è›‹åœ¨ä¸€èµ·çš„ç¬¬ <span id="loveDays"></span> å¤© <span class="heart">â¤ï¸</span></h1>
  <div class="timer" id="beijingTime"></div>
  <div class="quote" id="quote"></div>
  <div class="music-control"><button id="musicToggle">æ’­æ”¾éŸ³ä¹ ğŸµ</button></div>
</div>
<audio id="bgm" loop>
  <source src="music.mp3" type="audio/mpeg">
</audio>

<script>
const CONFIG = {
  startDate: new Date("2024-02-09T00:00:00"),
  quotes: [
    "æœ‰ä½ åœ¨çš„æ—¥å­ï¼Œæ¯ä¸€å¤©éƒ½æ˜¯æƒ…äººèŠ‚ã€‚",
    "ä½ ç¬‘èµ·æ¥çš„æ ·å­ï¼Œæ˜¯æˆ‘è§è¿‡æœ€ç¾çš„é£æ™¯ã€‚",
    "é™ªä½ èµ°è¿‡çš„æ¯ä¸€æ­¥ï¼Œéƒ½æ˜¯æˆ‘æœ€çè´µçš„å›å¿†ã€‚",
    "æ—¶é—´ä¼šè€å»ï¼Œä½†æˆ‘ä»¬çš„çˆ±ä¸ä¼šã€‚",
    "æ˜Ÿæ²³æ»šçƒ«ï¼Œä½ æ˜¯äººé—´ç†æƒ³ã€‚",
    "æˆ‘è§è¿‡çš„é£æ™¯å¾ˆå¤šï¼Œä½†æœ€å–œæ¬¢çš„è¿˜æ˜¯ä½ ã€‚",
    "ä¸–ç•Œå†å¤§ï¼Œæˆ‘çš„çœ¼ä¸­ä¹Ÿåªæœ‰ä½ ã€‚",
    "é‡è§ä½ ï¼Œæ˜¯æˆ‘æœ€ç¾çš„æ„å¤–ã€‚",
    "å’Œä½ åœ¨ä¸€èµ·çš„æ—¥å­ï¼Œæ‰å«æ—¶å…‰ã€‚",
    "ä½ æ˜¯æˆ‘ç–²æƒ«ç”Ÿæ´»é‡Œçš„æ¸©æŸ”æ¢¦æƒ³ã€‚",
    "æ‰€æœ‰çš„æ¸©æŸ”å’Œæµªæ¼«ï¼Œéƒ½è—åœ¨ä½ çš„åå­—é‡Œã€‚",
    "æˆ‘æƒ³å’Œä½ ä¸€èµ·æ…¢æ…¢å˜è€ã€‚",
    "çˆ±ä½ ï¼Œæ˜¯æˆ‘æœ€åšå®šçš„é€‰æ‹©ã€‚",
    "ä½ æ˜¯æˆ‘æ­¤ç”Ÿå”¯ä¸€çš„å¿ƒåŠ¨ã€‚",
    "åœ¨æˆ‘çš„ä¸–ç•Œé‡Œï¼Œä½ æ˜¯å”¯ä¸€çš„å…‰ã€‚",
    "ä½ æ˜¯æˆ‘å¿ƒåº•æœ€æŸ”è½¯çš„ç‰µæŒ‚ã€‚",
    "ä¸€æƒ³åˆ°ä½™ç”Ÿæœ‰ä½ ï¼Œå°±å……æ»¡æœŸå¾…ã€‚",
    "ä½ æ˜¯æˆ‘çœ¼ä¸­æœ€ç¾çš„é£æ™¯çº¿ã€‚",
    "æˆ‘æ„¿åŒ–ä½œæ˜Ÿè¾°ï¼Œåªä¸ºå®ˆæŠ¤ä½ ã€‚",
    "ä½ çš„ç¬‘ï¼Œæ˜¯æˆ‘æ¯å¤©çš„å¤ªé˜³ã€‚",
    "æˆ‘æƒ³ç‰µä½ çš„æ‰‹ï¼Œä¸€ç›´èµ°åˆ°ç™½å‘è‹è‹ã€‚",
    "å’Œä½ ä¸€èµ·çš„æ¯ä¸€ç§’ï¼Œéƒ½æ˜¯ç¤¼ç‰©ã€‚",
    "ä½ æ˜¯æˆ‘å¿ƒä¸­çš„ä¸å˜ä¿¡ä»°ã€‚",
    "æˆ‘æ„¿æ„ä¸ºä½ æŒ¡ä½æ‰€æœ‰é£é›¨ã€‚",
    "è¿™ä¸€ç”Ÿï¼Œæœ‰ä½ è¶³çŸ£ã€‚",
    "ä½ æ˜¯æˆ‘æœ€æ·±çš„æ‰§å¿µã€‚",
    "ä½ æ˜¯æˆ‘ç”Ÿå‘½ä¸­æœ€äº®çš„å…‰ã€‚",
    "å’Œä½ åœ¨ä¸€èµ·ï¼Œæ‰æœ‰äº†å®¶çš„æ„Ÿè§‰ã€‚",
    "æ¯ä¸€æ¬¡æƒ³ä½ ï¼Œå¿ƒé‡Œéƒ½å¼€å‡ºèŠ±æ¥ã€‚",
    "ä½ æ˜¯æˆ‘æ‰€æœ‰æ•…äº‹çš„ä¸»è§’ã€‚",
    "ä½ æ˜¯æˆ‘çš„ä»Šå¤©ï¼Œä¹Ÿæ˜¯æˆ‘çš„æ˜å¤©ã€‚",
    "æœ‰ä½ åœ¨ï¼Œè¿ç©ºæ°”éƒ½æ˜¯ç”œçš„ã€‚",
    "ä½ æ˜¯æˆ‘æ¢¦é‡Œæœ€æ¸©æŸ”çš„è¯—ã€‚",
    "ä½ æ˜¯æˆ‘å¿ƒä¸­æ°¸ä¸è½çš„æ˜Ÿã€‚",
    "çˆ±ä½ ï¼Œæ˜¯æˆ‘æ¯å¤©æœ€æƒ³åšçš„äº‹ã€‚",
    "ä½ çš„åå­—ï¼Œæ˜¯æˆ‘å”‡è¾¹æœ€ç¾çš„è¯ã€‚",
    "æˆ‘æƒ³æŠŠæ‰€æœ‰æ¸©æŸ”éƒ½ç»™ä½ ã€‚",
    "ä½ æ˜¯æˆ‘ç”Ÿå‘½ä¸­æœ€å¹¸è¿çš„é‡è§ã€‚",
    "æˆ‘ä¼šä¸€ç›´çˆ±ä½ ï¼Œä¸è®ºé£é›¨ã€‚",
    "ä½ æ˜¯æˆ‘å¿ƒé‡Œæœ€æŸ”è½¯çš„åœ°æ–¹ã€‚",
    "ä½ æ˜¯æˆ‘çš„é¿é£æ¸¯ï¼Œä¹Ÿæ˜¯æˆ‘çš„æ–¹å‘ã€‚",
    "ä½ æ˜¯æˆ‘å”¯ä¸€çš„ç­”æ¡ˆã€‚",
    "æ¯ä¸€æ¬¡æ‹¥æŠ±ä½ ï¼Œéƒ½åƒå›åˆ°å®¶ã€‚",
    "æˆ‘æƒ³å’Œä½ çœ‹éä¸–é—´é£æ™¯ã€‚",
    "ä½ æ˜¯æˆ‘çœ¼é‡Œæœ€äº®çš„æ˜Ÿã€‚",
    "æˆ‘æ„¿æ„ä¸€ç”Ÿå®ˆæŠ¤ä½ ã€‚",
    "æœ‰ä½ åœ¨çš„æ—¥å­ï¼Œæ‰å«ç”Ÿæ´»ã€‚",
    "ä½ æ˜¯æˆ‘å¿ƒä¸­çš„å”¯ä¸€é€‰æ‹©ã€‚",
    "æˆ‘ä¼šçˆ±ä½ ï¼Œç›´åˆ°æ—¶é—´çš„å°½å¤´ã€‚"
  ]
};

const loveDaysEl = document.getElementById("loveDays");
const beijingTimeEl = document.getElementById("beijingTime");
const quoteEl = document.getElementById("quote");
const audio = document.getElementById("bgm");
const toggleBtn = document.getElementById("musicToggle");

function fadeAudio(targetVolume, duration = 1000, callback) {
  const startVolume = audio.volume;
  const startTime = performance.now();
  function step(now) {
    const progress = Math.min((now - startTime) / duration, 1);
    audio.volume = startVolume + (targetVolume - startVolume) * progress;
    if (progress < 1) {
      requestAnimationFrame(step);
    } else if (callback) callback();
  }
  requestAnimationFrame(step);
}

function updateDays() {
  loveDaysEl.textContent = Math.floor((Date.now() - CONFIG.startDate) / 86400000);
}

function updateBeijingTime() {
  const now = new Date();
  const beijing = new Date(now.getTime() + now.getTimezoneOffset() * 60000 + 8 * 3600000);
  beijingTimeEl.textContent = "åŒ—äº¬æ—¶é—´ï¼š" + beijing.toLocaleTimeString("zh-CN", { hour12: false });
}

// æ‰“å­—æœºæ•ˆæœ
let quoteIndex = 0;
function typeWriter(text, callback) {
  let i = 0;
  quoteEl.textContent = "";
  function typing() {
    if (i < text.length) {
      quoteEl.textContent += text.charAt(i);
      i++;
      setTimeout(typing, 80);
    } else if (callback) {
      setTimeout(callback, 2000);
    }
  }
  typing();
}
function playQuotes() {
  typeWriter(CONFIG.quotes[quoteIndex], () => {
    quoteIndex = (quoteIndex + 1) % CONFIG.quotes.length;
    playQuotes();
  });
}

// ç²’å­åŠ¨ç”»
const canvas = document.querySelector(".particles");
const ctx = canvas.getContext("2d");
let particles = [];
function resizeCanvas() {
  canvas.width = innerWidth;
  canvas.height = innerHeight;
  particles = Array.from({ length: 30 }, createParticle);
}
function createParticle() {
  return {
    x: Math.random() * canvas.width,
    y: Math.random() * canvas.height,
    size: 10 * Math.random() + 10,
    speed: Math.random() + 0.5,
    opacity: Math.random()
  };
}
function drawParticles() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  ctx.fillStyle = "rgba(255,100,150,0.6)";
  ctx.font = "15px sans-serif";
  particles.forEach(p => {
    ctx.globalAlpha = p.opacity;
    ctx.fillText("â¤", p.x, p.y);
    p.y -= p.speed;
    if (p.y < -20) Object.assign(p, createParticle(), { y: canvas.height + 10 });
  });
  ctx.globalAlpha = 1;
}

function mainLoop(timestamp) {
  updateDays();
  updateBeijingTime();
  drawParticles();
  requestAnimationFrame(mainLoop);
}

function tryAutoPlay() {
  audio.volume = 0;
  audio.play().then(() => {
    fadeAudio(1, 2000);
    toggleBtn.textContent = "æš‚åœéŸ³ä¹ â¸ï¸";
  }).catch(() => {
    toggleBtn.textContent = "æ’­æ”¾éŸ³ä¹ ğŸµ";
  });
}

toggleBtn.addEventListener("click", () => {
  if (audio.paused) {
    audio.play().then(() => {
      fadeAudio(1, 2000);
      toggleBtn.textContent = "æš‚åœéŸ³ä¹ â¸ï¸";
    });
  } else {
    fadeAudio(0, 1500, () => {
      audio.pause();
      toggleBtn.textContent = "æ’­æ”¾éŸ³ä¹ ğŸµ";
    });
  }
});

addEventListener("resize", resizeCanvas);
resizeCanvas();
document.addEventListener("DOMContentLoaded", () => {
  tryAutoPlay();
  playQuotes();
});
mainLoop(0);
</script>
</body>
</html>
